(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{4345:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var l=s(5155),n=s(2115),a=s(63),r=s(8337),o=s(8826),c=s(6908),i=s(6653);function d(e){let{title:t,icon:s,isOpen:n,onToggle:a,children:r}=e;return(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[(0,l.jsxs)("button",{type:"button",onClick:a,className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("span",{className:"text-2xl",children:s}),(0,l.jsx)("span",{className:"font-semibold text-gray-900",children:t})]}),(0,l.jsx)("svg",{className:"w-5 h-5 text-gray-400 transition-transform duration-200 ".concat(n?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&(0,l.jsx)("div",{className:"px-4 pb-4 border-t border-gray-100",children:(0,l.jsx)("div",{className:"pt-4 space-y-4",children:r})})]})}function u(){var e,t,s,u,p,m;let[h,x]=(0,n.useState)(c.ji),[g,j]=(0,n.useState)(!0),[v,b]=(0,n.useState)(!1),[f,N]=(0,n.useState)(null),[y,C]=(0,n.useState)({basics:!0,product:!1,target:!1,style:!1,preference:!1}),w=(0,a.useRouter)(),{t:k,language:P}=(0,r.o)(),{user:A,loading:O}=(0,o.A)();(0,n.useEffect)(()=>{(async()=>{if(O)return;if(!A)return w.push("/");let e=null;(e=A?await (0,c.rG)(A.uid):(0,c.iH)())&&x(e),j(!1)})()},[w,A,O]);let S=(e,t)=>{x(s=>({...s,[e]:t}))},E=(e,t)=>{let s=h[e];s.includes(t)?S(e,s.filter(e=>e!==t)):S(e,[...s,t])},W=e=>{C(t=>({...t,[e]:!t[e]}))},L=async()=>{if(A){b(!0),N(null);try{let e={...h,language:P};await (0,c.H9)(A.uid,e),N(k.common.saved),setTimeout(()=>N(null),3e3)}catch(t){var e;console.error("儲存失敗:",t),N((null==(e=k.profile)?void 0:e.saveError)||"Error saving")}finally{b(!1)}}};return g?(0,l.jsx)(i.A,{children:(0,l.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-500",children:k.common.loading})]})})}):(0,l.jsx)(i.A,{children:(0,l.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:(null==(e=k.profile)?void 0:e.title)||k.sidebar.myProfile}),(0,l.jsx)("p",{className:"text-gray-600 mt-1",children:(null==(t=k.profile)?void 0:t.subtitle)||"Edit your profile information"})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)(d,{title:k.contentClone.steps.basics,icon:"\uD83D\uDC64",isOpen:y.basics,onToggle:()=>W("basics"),children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step1.name}),(0,l.jsx)("input",{type:"text",value:h.name,onChange:e=>S("name",e.target.value),className:"form-input",placeholder:k.contentClone.step1.namePlaceholder})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step1.industry}),(0,l.jsxs)("select",{value:h.industry,onChange:e=>S("industry",e.target.value),className:"form-input",children:[(0,l.jsx)("option",{value:"",children:k.contentClone.step1.industryPlaceholder}),k.industries.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step1.jobTitle}),(0,l.jsx)("input",{type:"text",value:h.jobTitle,onChange:e=>S("jobTitle",e.target.value),className:"form-input",placeholder:k.contentClone.step1.jobTitlePlaceholder})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step1.experience}),(0,l.jsxs)("select",{value:h.yearsExperience,onChange:e=>S("yearsExperience",e.target.value),className:"form-input",children:[(0,l.jsx)("option",{value:"",children:k.contentClone.step1.experiencePlaceholder}),k.experienceOptions.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]})]}),(0,l.jsxs)(d,{title:k.contentClone.steps.product,icon:"\uD83D\uDCE6",isOpen:y.product,onToggle:()=>W("product"),children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step2.product}),(0,l.jsx)("textarea",{value:h.productService,onChange:e=>S("productService",e.target.value),className:"form-textarea",rows:4,placeholder:k.contentClone.step2.productPlaceholder})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step2.advantage}),(0,l.jsx)("textarea",{value:h.productAdvantage,onChange:e=>S("productAdvantage",e.target.value),className:"form-textarea",rows:3,placeholder:k.contentClone.step2.advantagePlaceholder})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step2.price}),(0,l.jsxs)("select",{value:h.priceRange,onChange:e=>S("priceRange",e.target.value),className:"form-input",children:[(0,l.jsx)("option",{value:"",children:k.contentClone.step2.pricePlaceholder}),k.priceOptions.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]})]}),(0,l.jsxs)(d,{title:k.contentClone.steps.target,icon:"\uD83C\uDFAF",isOpen:y.target,onToggle:()=>W("target"),children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step3.idealCustomer}),(0,l.jsx)("textarea",{value:h.idealCustomer,onChange:e=>S("idealCustomer",e.target.value),className:"form-textarea",rows:3,placeholder:k.contentClone.step3.idealCustomerPlaceholder})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step3.painPoints}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-2 mt-2",children:k.painPointOptions.map(e=>(0,l.jsxs)("label",{className:"flex items-center space-x-2 p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[(0,l.jsx)("input",{type:"checkbox",checked:h.painPoints.includes(e),onChange:()=>E("painPoints",e),className:"w-4 h-4 text-blue-600"}),(0,l.jsx)("span",{className:"text-sm",children:e})]},e))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step3.commonQuestions}),(0,l.jsx)("div",{className:"space-y-3 mt-2",children:[0,1,2].map(e=>(0,l.jsx)("input",{type:"text",value:h.commonQuestions[e]||"",onChange:t=>((e,t)=>{let s=[...h.commonQuestions];s[e]=t,S("commonQuestions",s)})(e,t.target.value),className:"form-input",placeholder:"".concat(k.contentClone.step3.questionPlaceholder," ").concat(e+1)},e))})]})]}),(0,l.jsxs)(d,{title:k.contentClone.steps.style,icon:"\uD83C\uDFA8",isOpen:y.style,onToggle:()=>W("style"),children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step4.tone}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-3 mt-2",children:k.toneOptions.map(e=>(0,l.jsxs)("label",{className:"p-4 border rounded-lg cursor-pointer ".concat(h.toneStyle===e?"border-blue-500 bg-blue-50":"hover:bg-gray-50"),children:[(0,l.jsx)("input",{type:"radio",name:"toneStyle",value:e,checked:h.toneStyle===e,onChange:e=>S("toneStyle",e.target.value),className:"sr-only"}),(0,l.jsx)("div",{className:"font-medium",children:e})]},e))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step4.catchphrases}),(0,l.jsx)("textarea",{value:h.catchphrases,onChange:e=>S("catchphrases",e.target.value),className:"form-textarea",rows:2,placeholder:k.contentClone.step4.catchphrasesPlaceholder})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step4.avoidWords}),(0,l.jsx)("input",{type:"text",value:h.avoidWords,onChange:e=>S("avoidWords",e.target.value),className:"form-input",placeholder:k.contentClone.step4.avoidWordsPlaceholder})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step4.sampleWriting}),(0,l.jsx)("textarea",{value:h.sampleWriting,onChange:e=>S("sampleWriting",e.target.value),className:"form-textarea",rows:4,placeholder:k.contentClone.step4.sampleWritingPlaceholder})]})]}),(0,l.jsxs)(d,{title:k.contentClone.steps.preference,icon:"⚙️",isOpen:y.preference,onToggle:()=>W("preference"),children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step5.platforms}),(0,l.jsx)("div",{className:"grid grid-cols-3 gap-2 mt-2",children:k.platformOptions.map(e=>(0,l.jsxs)("label",{className:"p-3 border rounded-lg cursor-pointer text-center ".concat(h.platforms.includes(e)?"border-blue-500 bg-blue-50":"hover:bg-gray-50"),children:[(0,l.jsx)("input",{type:"checkbox",checked:h.platforms.includes(e),onChange:()=>E("platforms",e),className:"sr-only"}),(0,l.jsx)("span",{className:"text-sm",children:e})]},e))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step5.contentLength}),(0,l.jsx)("div",{className:"grid grid-cols-3 gap-3 mt-2",children:k.lengthOptions.map(e=>(0,l.jsxs)("label",{className:"p-4 border rounded-lg cursor-pointer text-center ".concat(h.contentLength===e?"border-blue-500 bg-blue-50":"hover:bg-gray-50"),children:[(0,l.jsx)("input",{type:"radio",name:"contentLength",value:e,checked:h.contentLength===e,onChange:e=>S("contentLength",e.target.value),className:"sr-only"}),(0,l.jsx)("div",{className:"text-sm font-medium",children:e})]},e))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:k.contentClone.step5.cta}),(0,l.jsx)("input",{type:"text",value:h.cta,onChange:e=>S("cta",e.target.value),className:"form-input",placeholder:k.contentClone.step5.ctaPlaceholder})]})]})]}),(0,l.jsxs)("div",{className:"mt-8 flex items-center justify-between",children:[(0,l.jsx)("div",{className:"flex items-center gap-2",children:f&&(0,l.jsx)("span",{className:"text-sm ".concat(f===k.common.saved?"text-green-600":"text-red-600"),children:f})}),(0,l.jsx)("button",{type:"button",onClick:L,disabled:v,className:"btn-primary flex items-center gap-2",children:v?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,l.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,l.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(null==(s=k.profile)?void 0:s.saving)||"Saving..."]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(null==(u=k.profile)?void 0:u.saveChanges)||k.common.save]})})]}),(0,l.jsxs)("div",{className:"mt-4 flex justify-center gap-4 text-sm",children:[(0,l.jsx)("button",{type:"button",onClick:()=>C({basics:!0,product:!0,target:!0,style:!0,preference:!0}),className:"text-blue-600 hover:text-blue-800",children:(null==(p=k.profile)?void 0:p.expandAll)||"Expand All"}),(0,l.jsx)("span",{className:"text-gray-300",children:"|"}),(0,l.jsx)("button",{type:"button",onClick:()=>C({basics:!1,product:!1,target:!1,style:!1,preference:!1}),className:"text-blue-600 hover:text-blue-800",children:(null==(m=k.profile)?void 0:m.collapseAll)||"Collapse All"})]})]})})}},5102:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var l=s(5155),n=s(8337);function a(){let{language:e,setLanguage:t,languageNames:s}=(0,n.o)();return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("select",{value:e,onChange:e=>t(e.target.value),className:"appearance-none bg-white border border-gray-200 rounded-lg px-3 py-1.5 pr-8 text-sm text-gray-700 cursor-pointer hover:border-blue-500 focus:outline-none focus:border-blue-500 transition-colors",children:["zh-TW","zh-CN","en","ms","ja","ko"].map(e=>(0,l.jsx)("option",{value:e,children:s[e]},e))}),(0,l.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-500",children:(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})}},6653:(e,t,s)=>{"use strict";s.d(t,{A:()=>d});var l=s(5155),n=s(2115),a=s(63),r=s(8826),o=s(8337),c=s(1871),i=s(5102);function d(e){let{children:t}=e,s=(0,a.useRouter)(),{user:d,loading:u}=(0,r.A)(),{t:p}=(0,o.o)();return((0,n.useEffect)(()=>{u||d||s.push("/")},[d,u,s]),u)?(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-500",children:p.common.loading})]})}):d?(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50 flex",children:[(0,l.jsx)(c.A,{}),(0,l.jsxs)("main",{className:"flex-1 lg:ml-0",children:[(0,l.jsx)("header",{className:"bg-white shadow-sm sticky top-0 z-20",children:(0,l.jsx)("div",{className:"flex items-center justify-end px-6 py-4",children:(0,l.jsx)(i.A,{})})}),(0,l.jsx)("div",{className:"p-6",children:t})]})]}):null}},6908:(e,t,s)=>{"use strict";s.d(t,{ji:()=>p,ML:()=>x,iH:()=>h,rG:()=>j,Lt:()=>m,H9:()=>g});var l=s(9390),n=s(8516);let a="users",r="profiles",o="main";function c(){if(!n.db)throw Error("Firestore 未初始化。請確認環境變數已正確設定。");return n.db}async function i(e,t){let s=c();try{let n=(0,l.H9)(s,a,e,r,o);(await (0,l.x7)(n)).exists()?await (0,l.mZ)(n,{...t,updatedAt:(0,l.O5)()}):await (0,l.BN)(n,{...t,createdAt:(0,l.O5)(),updatedAt:(0,l.O5)()})}catch(e){throw console.error("儲存 Profile 失敗:",e),Error("無法儲存用戶資料，請稍後再試")}}async function d(e){let t=c();try{let s=(0,l.H9)(t,a,e,r,o),n=await (0,l.x7)(s);if(n.exists())return n.data();return null}catch(e){throw console.error("讀取 Profile 失敗:",e),Error("無法讀取用戶資料，請稍後再試")}}let u="closer_user_profile",p={name:"",industry:"",jobTitle:"",yearsExperience:"",productService:"",productAdvantage:"",priceRange:"",idealCustomer:"",painPoints:[],commonQuestions:["","",""],toneStyle:"",catchphrases:"",avoidWords:"",sampleWriting:"",platforms:[],contentLength:"",cta:"",language:"zh-TW"};function m(e){localStorage.setItem(u,JSON.stringify(e))}function h(){let e=localStorage.getItem(u);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}function x(){let e=h();return!!e&&!!(e.name&&e.industry)}async function g(e,t){m(t),await i(e,t)}async function j(e){try{let t=await d(e);if(t)return m(t),t;return h()}catch(e){return console.error("載入雲端 Profile 失敗，使用本地資料:",e),h()}}},7194:(e,t,s)=>{Promise.resolve().then(s.bind(s,4345))}},e=>{e.O(0,[153,563,320,176,168,871,441,493,358],()=>e(e.s=7194)),_N_E=e.O()}]);