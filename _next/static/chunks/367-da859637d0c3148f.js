"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[367],{5102:(e,r,a)=>{a.d(r,{A:()=>l});var s=a(5155),t=a(8337);function l(){let{language:e,setLanguage:r,languageNames:a}=(0,t.o)();return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("select",{value:e,onChange:e=>r(e.target.value),className:"appearance-none bg-white border border-gray-200 rounded-lg px-3 py-1.5 pr-8 text-sm text-gray-700 cursor-pointer hover:border-blue-500 focus:outline-none focus:border-blue-500 transition-colors",children:["zh-TW","zh-CN","en","ms","ja","ko"].map(e=>(0,s.jsx)("option",{value:e,children:a[e]},e))}),(0,s.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-500",children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})}},6908:(e,r,a)=>{a.d(r,{ji:()=>x,ML:()=>p,iH:()=>m,rG:()=>b,Lt:()=>h,H9:()=>f});var s=a(9390),t=a(8516);let l="users",n="profiles",o="main";function i(){if(!t.db)throw Error("Firestore 未初始化。請確認環境變數已正確設定。");return t.db}async function c(e,r){let a=i();try{let t=(0,s.H9)(a,l,e,n,o);(await (0,s.x7)(t)).exists()?await (0,s.mZ)(t,{...r,updatedAt:(0,s.O5)()}):await (0,s.BN)(t,{...r,createdAt:(0,s.O5)(),updatedAt:(0,s.O5)()})}catch(e){throw console.error("儲存 Profile 失敗:",e),Error("無法儲存用戶資料，請稍後再試")}}async function d(e){let r=i();try{let a=(0,s.H9)(r,l,e,n,o),t=await (0,s.x7)(a);if(t.exists())return t.data();return null}catch(e){throw console.error("讀取 Profile 失敗:",e),Error("無法讀取用戶資料，請稍後再試")}}let u="closer_user_profile",x={name:"",industry:"",jobTitle:"",yearsExperience:"",productService:"",productAdvantage:"",priceRange:"",idealCustomer:"",painPoints:[],commonQuestions:["","",""],toneStyle:"",catchphrases:"",avoidWords:"",sampleWriting:"",platforms:[],contentLength:"",cta:"",language:"zh-TW"};function h(e){localStorage.setItem(u,JSON.stringify(e))}function m(){let e=localStorage.getItem(u);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}function p(){let e=m();return!!e&&!!(e.name&&e.industry)}async function f(e,r){h(r),await c(e,r)}async function b(e){try{let r=await d(e);if(r)return h(r),r;return m()}catch(e){return console.error("載入雲端 Profile 失敗，使用本地資料:",e),m()}}},9648:(e,r,a)=>{a.d(r,{A:()=>x});var s=a(5155),t=a(2115),l=a(63),n=a(8826),o=a(8337),i=a(2619),c=a.n(i);function d(){var e,r;let[a,i]=(0,t.useState)(!1),d=(0,l.usePathname)(),{user:u,signOut:x}=(0,n.A)(),{t:h}=(0,o.o)(),m=[{href:"/dashboard",label:h.sidebar.dashboard,icon:"\uD83D\uDCCA",available:!0},{href:"/content-clone",label:h.sidebar.contentClone,icon:"✨",available:!0},{href:"/customer-lens",label:h.sidebar.customerLens,icon:"\uD83D\uDD0D",available:!0},{href:"/proposal-machine",label:h.sidebar.proposalMachine,icon:"\uD83D\uDCB0",available:!0},{href:"/follow-up",label:h.sidebar.followUp,icon:"\uD83D\uDD04",available:!0}],p=async()=>{try{await x()}catch(e){console.error("登出失敗:",e)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>i(!a),className:"lg:hidden fixed top-4 left-4 z-50 p-2 bg-white rounded-lg shadow-md","aria-label":"Toggle menu",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a?(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),a&&(0,s.jsx)("div",{className:"lg:hidden fixed inset-0 bg-black/50 z-30",onClick:()=>i(!1)}),(0,s.jsx)("aside",{className:"\n          fixed top-0 left-0 z-40 h-full w-64 bg-white shadow-lg\n          transform transition-transform duration-300 ease-in-out\n          lg:translate-x-0 lg:static lg:z-auto\n          ".concat(a?"translate-x-0":"-translate-x-full","\n        "),children:(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsx)("div",{className:"p-6 border-b border-gray-100",children:(0,s.jsxs)(c(),{href:"/dashboard",className:"block",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-blue-600",children:"CLOSER"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Close More, Work Less"})]})}),(0,s.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-100",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-blue-600 font-medium",children:(null==u||null==(e=u.displayName)?void 0:e.charAt(0))||(null==u||null==(r=u.email)?void 0:r.charAt(0))||"?"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:(null==u?void 0:u.displayName)||"使用者"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 truncate",children:null==u?void 0:u.email})]})]})}),(0,s.jsxs)("nav",{className:"flex-1 px-4 py-6 overflow-y-auto",children:[(0,s.jsx)("ul",{className:"space-y-2",children:m.map(e=>{var r;return(0,s.jsx)("li",{children:e.available?(0,s.jsxs)(c(),{href:e.href,onClick:()=>i(!1),className:"\n                        flex items-center gap-3 px-4 py-3 rounded-lg\n                        transition-colors duration-200\n                        ".concat(("/dashboard"===(r=e.href)?"/dashboard"===d:d.startsWith(r))?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900","\n                      "),children:[(0,s.jsx)("span",{className:"text-xl",children:e.icon}),(0,s.jsx)("span",{className:"font-medium",children:e.label})]}):(0,s.jsxs)("div",{className:"flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 cursor-not-allowed",children:[(0,s.jsx)("span",{className:"text-xl opacity-50",children:e.icon}),(0,s.jsx)("span",{className:"font-medium",children:e.label}),(0,s.jsx)("span",{className:"ml-auto text-xs bg-gray-100 px-2 py-1 rounded",children:h.dashboard.comingSoon})]})},e.href)})}),(0,s.jsx)("div",{className:"my-6 border-t border-gray-100"}),(0,s.jsxs)(c(),{href:"/profile",onClick:()=>i(!1),className:"\n                flex items-center gap-3 px-4 py-3 rounded-lg\n                transition-colors duration-200\n                ".concat("/profile"===d?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900","\n              "),children:[(0,s.jsx)("span",{className:"text-xl",children:"\uD83D\uDC64"}),(0,s.jsx)("span",{className:"font-medium",children:h.sidebar.myProfile})]})]}),(0,s.jsx)("div",{className:"p-4 border-t border-gray-100",children:(0,s.jsxs)("button",{onClick:p,className:"w-full flex items-center justify-center gap-2 px-4 py-3 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200",children:[(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),(0,s.jsx)("span",{className:"font-medium",children:h.sidebar.logout})]})})]})})]})}var u=a(5102);function x(e){let{children:r}=e,a=(0,l.useRouter)(),{user:i,loading:c}=(0,n.A)(),{t:x}=(0,o.o)();return((0,t.useEffect)(()=>{c||i||a.push("/")},[i,c,a]),c)?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-500",children:x.common.loading})]})}):i?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 flex",children:[(0,s.jsx)(d,{}),(0,s.jsxs)("main",{className:"flex-1 lg:ml-0",children:[(0,s.jsx)("header",{className:"bg-white shadow-sm sticky top-0 z-20",children:(0,s.jsx)("div",{className:"flex items-center justify-end px-6 py-4",children:(0,s.jsx)(u.A,{})})}),(0,s.jsx)("div",{className:"p-6",children:r})]})]}):null}}}]);